<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OpenClaw Secure Installer</title>
    <link rel="stylesheet" href="./style.css" />
    <script type="module" src="/src/main.ts" defer></script>
  </head>
  <body>
    <div class="container">
      <h1>OpenClaw Secure Installer</h1>
      
      <!-- Stepper / Progress -->
      <div class="stepper">
        <div class="step active" id="step-1-indicator">1. Check</div>
        <div class="step" id="step-2-indicator">2. Configure</div>
        <div class="step" id="step-3-indicator">3. Install</div>
        <div class="step" id="step-4-indicator">4. Run</div>
      </div>

      <hr class="separator" />

      <!-- Step 1: Docker Check -->
      <div id="step-1" class="step-content active">
        <h2>System Check</h2>
        <div class="card">
            <div class="status-row">
              <span>Docker CLI:</span>
              <span id="status-cli" class="pill neutral">Pending</span>
              <span id="version-cli" class="version-info"></span>
            </div>
            <div class="status-row">
              <span>Docker Daemon:</span>
              <span id="status-daemon" class="pill neutral">Pending</span>
              <span id="version-server" class="version-info"></span>
            </div>
            <div class="status-row">
              <span>Docker Compose:</span>
              <span id="status-compose" class="pill neutral">Pending</span>
              <span id="version-compose" class="version-info"></span>
            </div>
        </div>

        <div id="remediation" class="alert hidden"></div>

        <div class="actions">
            <button id="check-docker" class="primary">Check System</button>
            <button id="step-1-next" class="secondary hidden">Next</button>
        </div>

        <details id="diagnostics-panel" class="hidden">
            <summary>Diagnostics</summary>
            <ul id="diagnostics"></ul>
        </details>
      </div>

      <!-- Step 2: Configure -->
      <div id="step-2" class="step-content hidden">
        <h2>Configuration</h2>
        <form id="config-form">
            <div class="form-group">
                <label for="http-port">HTTP Port</label>
                <input type="number" id="http-port" value="80" />
            </div>
            <div class="form-group">
                <label for="https-port">HTTPS Port</label>
                <input type="number" id="https-port" value="443" />
            </div>
            <div class="form-group">
                <label>Safe Mode</label>
                <div style="display:flex; align-items:center;">
                  <input type="checkbox" checked disabled id="safe-mode" />
                  <span style="margin-left: 0.5rem;">Enabled (Enforced)</span>
                </div>
            </div>
            <div class="form-group">
                <label>Storage Path</label>
                <div id="app-data-path" class="path-display text-muted text-small">Loading...</div>
            </div>
        </form>
        <div class="actions">
            <button id="step-2-next" class="primary">Save & Configure</button>
        </div>
      </div>

      <!-- Step 3: Install/Start -->
      <div id="step-3" class="step-content hidden">
        <h2>Installation</h2>
        <p>Pulling images and starting Gateway...</p>
        <div class="terminal" id="install-logs">Waiting to start...</div>
        <div class="actions">
            <button id="start-gateway" class="primary">Start Gateway</button>
        </div>
      </div>

      <!-- Step 4: Running -->
      <div id="step-4" class="step-content hidden">
        <h2>Gateway Running</h2>
        <div class="success-card">
            <p>âœ… OpenClaw Gateway is active.</p>
            <p>Local URL: <a href="http://localhost" target="_blank">http://localhost</a></p>
        </div>
        <div class="actions">
            <button id="stop-gateway" class="danger">Stop Gateway</button>
            <button id="view-logs" class="secondary">View Logs</button>
        </div>
        <div class="terminal hidden" id="runtime-logs"></div>
      </div>

      <div class="footer">
        <p id="install-id" class="text-small text-muted"></p>
      </div>
    </div>
  </body>
</html>
